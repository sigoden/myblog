{"data":{"site":{"siteMetadata":{"title":"Sigoden | Blog","siteUrl":"https://blog.sigoden.com","siteAuthor":"sigoden","githubUrl":"https://github.com/sigoden"}},"markdownRemark":{"html":"<p>Electron 是一款可以通过 Web 技术构建跨平台桌面应用的框架。它将 Chromium 和 Node.js 的事件循环整合在一起，并提供了一些与原生系统交互的 API。</p>\n<p>通过 Electron，我们可以使用自己所熟悉的前端技术轻松构建出一款能运行在 Windows, Linux 和 Mac 上的桌面级应用程序。已经有很多文章介绍了如何开发全平台应用，但是如何高效便捷的构建软件安装包并面向公众发布却较少被提及。本文将介绍一种简单高效的方法构建并发布安装包。</p>\n<p><a href=\"https://github.com/sigoden/alphat\">AlphaT</a> 是我最近使用 electron 开发的一款应用。这款应用的构建和发布中的一些经验和总结，催生了这篇博文。</p>\n<p>简单说一下构建和发布流程：配置构建工具 <a href=\"https://github.com/electron-userland/electron-builder\">electron-builder</a>, 配置 <a href=\"http://www.appveyor.com/\">Travis</a> 以构建 Linux 和 Mac 应用，配置 <a href=\"http://www.appveyor.com/\">AppVeyor</a> 以构建 Windows 应用，当提交代码到 Github 后，CI 自动拉取代码，运行 electron-builder 相关命令，生成个平台的安装包，并将安装包推送到 Github Releases 中。</p>\n<p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2a849dc4e78806b5d648dc322e3a0635/f3ccd/alphat-release.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 786px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 80.85106382978722%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAIAAACZeshMAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz42TWVLDMAyGc30eOA8zHIalpZC6iXfLi7ygNKUQmhb+8Xg0sj7J8tINwvYctjyElBNmzIXmecw2zQ7Ce79XxkpluFRCGSE1Yu40H7TgyoADT0NqAz4Y6yx4bV2ISHxM6HwIMdEge/bQ3N09jPePA0XXWkqpmHM9WrPIbktxKfdsYAOntY5pZDpRXGv1MvRSlD2mFGMiu5scOeZx00DsZN7xyVvrrUTUrXPwBbdmrQ0hSCP7PRNCSqmo8+N21jVn7n66AMBMsh58+4cWMDsMT8+vfc9uM/OJ/oZH7TdD2onEFLpYTq0vRWGJbg7gN8wJHlOvkoIM12FEBO9X4fghk4R8PvNLTfBq5S2nyjgaPD6Q9coxxpVtCzP1rG6WpSXvw+Kez/AbjxHrdfZUGWCt55dDpJ3TT7qOfz++BZxLwUx/o5b6xz3P/Cdw4qvhv5Wz+AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\"\n        alt=\"alphat release\"\n        title=\"\"\n        src=\"/static/2a849dc4e78806b5d648dc322e3a0635/73d01/alphat-release.png\"\n        srcset=\"/static/2a849dc4e78806b5d648dc322e3a0635/a3b1f/alphat-release.png 197w,\n/static/2a849dc4e78806b5d648dc322e3a0635/07137/alphat-release.png 393w,\n/static/2a849dc4e78806b5d648dc322e3a0635/73d01/alphat-release.png 786w,\n/static/2a849dc4e78806b5d648dc322e3a0635/f3ccd/alphat-release.png 1034w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>仅仅进行 git 提交就能自动构建并发布，这么酷的事情一定很复杂吧？</p>\n<p>实际上并不复杂，都只是一些简单配置而已。顺便说一句，对于开源项目，Travis 和 AppVeyor 是能够免费使用的。下面我会一步一步进行说明。</p>\n<h2 id=\"使用-electron-builder\"><a href=\"#%E4%BD%BF%E7%94%A8-electron-builder\" aria-label=\"使用 electron builder permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用 electron-builder</h2>\n<p>electron-builder 是一款 electron 应用打包工具，简单配置就可以生成各种不同平台不同格式的安装包。支持的包有：mac 平台的 mas, dmg, pkg；win 平台的 nsis, nsisWeb, portable, appx, squirrelWindows；linux 平台的 deb, snap, appImage, pacman, rpm, freebsd, p5p, apk。同时，它还支持将构建的安装包上传到 Github Releases, Amazon S3 等服务中。从构建到发布，我们唯一剩下要做的就是正确配置。</p>\n<ul>\n<li>安装</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">npm install electron-builder --save-dev</code></pre></div>\n<ul>\n<li>添加脚本</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;postinstall&quot;: &quot;electron-builder install-app-deps&quot;,\n&quot;dist&quot;: &quot;electron-builder --publish onTagOrDraft&quot;</code></pre></div>\n<p>其中 <code class=\"language-text\">postinstall</code> 不是必须的，只有在使用了原生模块时需要。</p>\n<p><code class=\"language-text\">--publish onTagOrDraft</code> 用来自动发布，详见<a href=\"https://github.com/electron-userland/electron-builder#cli-usage\">文档</a></p>\n<ul>\n<li>构建配置</li>\n</ul>\n<p>electron 可以从 <code class=\"language-text\">package.json</code> 的 <code class=\"language-text\">build</code> 中读取配置信息</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;build&quot;: {\n  &quot;appId&quot;: &quot;com.sigoden.alphat&quot;,\n  &quot;mac&quot;: {\n    &quot;category&quot;: &quot;public.app-category.utilities&quot;\n  },\n  &quot;dmg&quot;: {\n    &quot;contents&quot;: [\n      {\n        &quot;x&quot;: 110,\n        &quot;y&quot;: 150\n      },\n      {\n        &quot;x&quot;: 240,\n        &quot;y&quot;: 150,\n        &quot;type&quot;: &quot;link&quot;,\n        &quot;path&quot;: &quot;/Applications&quot;\n      }\n    ]\n  },\n  &quot;win&quot;: {\n    &quot;target&quot;: &quot;nsis&quot;\n  },\n  &quot;linux&quot;: {\n    &quot;category&quot;: &quot;Utility&quot;,\n    &quot;target&quot;: [\n      &quot;deb&quot;,\n      &quot;AppImage&quot;\n    ]\n  }\n}</code></pre></div>\n<p><code class=\"language-text\">mac</code> 和 <code class=\"language-text\">dmg</code> 将指导 electron-builder 构建适用于苹果系统的应用，<code class=\"language-text\">win</code> 指导构建 windows 应用，它表明制作安装包为 nsis 格式，<code class=\"language-text\">linux</code> 用于构建 linux 应用，它将生成安装包 deb 和 appImage。</p>\n<p><code class=\"language-text\">mac</code> 和 <code class=\"language-text\">linux</code> 下的 category 必须，具体有那些可选字段参考 <a href=\"https://developer.apple.com/app-store/categories/\">mac category</a> 和 <a href=\"https://gist.githubusercontent.com/sigoden/d31049af934844ee4055c37fa70a843c/raw/71ddf814b0a83e9327d00892ef14586a72811f61/linux%2520application%2520category\">linux category</a></p>\n<ul>\n<li>提供 icon</li>\n</ul>\n<p>icon 是必须的，缺失和尺寸错误均将造成构建失败。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">build\n├── icon.icns\n├── icon.ico\n└── icons\n    ├── 1024x1024.png\n    ├── 128x128.png\n    ├── 16x16.png\n    ├── 24x24.png\n    ├── 256x256.png\n    ├── 32x32.png\n    ├── 48x48.png\n    ├── 512x512.png\n    ├── 64x64.png\n    └── 96x96.png</code></pre></div>\n<p>我提供了一个自动从一张 1024x1204 png 图片生成这一切的 <a href=\"https://gist.githubusercontent.com/sigoden/02aaf1201a43bc9257362aea090783d7/raw/79cddde8f9a410ef00d9acc21d18c48ac45a446f/makeicon\">shell 脚本</a>。\n当然，你也可以使用在线工具如 <a href=\"https://iconverticons.com/online/\">https://iconverticons.com/online/</a>、<a href=\"https://cloudconvert.com\">https://cloudconvert.com</a> 进行 icon 转换和制作。</p>\n<h2 id=\"生成-gh_token\"><a href=\"#%E7%94%9F%E6%88%90-gh_token\" aria-label=\"生成 gh_token permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>生成 GH_TOKEN</h2>\n<p>electron-builder 需要 GH<em>TOKEN(Github Personal access token) 才有权限上传文件到 Github Releases 中。该 Token 在 <a href=\"https://github.com/settings/tokens\">github token 配置页面</a> 中进行设置。由于我们的 CI 只需要公用仓储的访问权限，所以只需要勾选`repo > public</em>repo` 复选框即可。这个 token 只显示一次，需要记录下来，我们在 CI 中配置 GH_TOKEN 环境变量时要用到这个值。</p>\n<h2 id=\"配置-ci\"><a href=\"#%E9%85%8D%E7%BD%AE-ci\" aria-label=\"配置 ci permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>配置 CI</h2>\n<p>你可能认为我们并不需要 CI。然而，我们需要为三种不同平台构建应用，而应用是有平台依赖的。你的 Linux 无法构建 Mac 应用，Linux 能通过 wine 构建 windows 应用，但是如此 hack 的行为你能相信构建成的应用的质量吗？正常来说是适用于特定平台的应用是需要在对应平台构建的。所以我们需要 CI，使用 AppVeyor 构建 windows 应用，使用 Travis 构建 Linux 和 Mac 应用。</p>\n<h3 id=\"appveyor\"><a href=\"#appveyor\" aria-label=\"appveyor permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>AppVeyor</h3>\n<p>这儿有一份简单（但包含需要的一切）的 <code class=\"language-text\">appveyor.yml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">platform:\n  - x64\n\ncache:\n  - node_modules\n  - &#39;%APPDATA%\\npm-cache&#39;\n  - &#39;%USERPROFILE%\\.electron&#39;\n\ninstall:\n  - ps: Install-Product node 8 x64\n  - npm install\n\nbuild_script:\n  - npm run dist\n\ntest: off\n\nbranches:\n  only:\n    - master</code></pre></div>\n<p>配置很简单明了，从字段名中我们看出各项参数的作用。需要注意的是 <code class=\"language-text\">install</code> 段，指定安装 node-v8-x64，然后安装包依赖。真正的构建由 <code class=\"language-text\">build_script</code> 段控制。<code class=\"language-text\">branches</code> 段表明只对 master 提交进行构建。</p>\n<p>不要忘记配置 GH_TOKEN 环境变量。</p>\n<p>可以直接在　<code class=\"language-text\">appveyor.yml</code> 中配置变量，　如下</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">environment:\n  GH_TOKEN:\n    secure: &lt;encrypt_value&gt;</code></pre></div>\n<p>其中的 <code class=\"language-text\">&lt;encrypt_value&gt;</code> 可以通过将 GH_TOKEN 用 AppVeyor 提供的 <a href=\"https://ci.appveyor.com/tools/encrypt\">工具</a> 加密后获得。</p>\n<p>你也可以在项目设置中配置\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/06163dfa2179d1fdcb3254429acc3bcd/84566/appveyor-env.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 786px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 78.28810020876827%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAABv0lEQVQ4y41U7XKbMBDkxfM4fYbkQfqn+dNMxjbjjAEJJPSFtL2TLRlj0lYzNwih2907rWgOxyO890gpIcaYnzmA/L4sC70jj1QmfxmNtTYneh9yMoNrNcHTulYKQsoKVMl2onxvur6DNQZLCIgEaAnw0Mschkj+dxTQpm1PEEMPZ2d4ZxEIuBcSYlJZtXfuVva1JevYVeicf2BipVIKjHKEnCYoUm8JdAtQooBXwGEYSNVSAb13aNsWl0sHJwRAoImT6JvWisgkxnHMT0NkBbQC8gcu89YJ+Jhw1B6DjwiDQDqfkYggETHTcvkl1qq/ASSFtPGiDaQLULF2HOg6gMD/eSjcL7ZOBaTyz5IOZIlZMZeb8oyCyz+dkKinaWOjqpB9xvLLcHzKs31mL6ZmcvJnVb41Npc8z/NDyd2kYSiRlZd2VEUrknwgt1jZxl2v3hpQzdBEwkTFVhVsVeJuD7cLgXom7Z1ge4fLPJIbUvB4Hw3e1Z20qU0tChYqUUvKCLguP9/jTMzWIV++HgTevsyVhAG3zBcb8ON3j4/J1k17pfE6K/xUDp9zuCssG0vi0Sx4+SXwc/S7gN/9xsraHwXN63AHuukAAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\"\n        alt=\"appveyor env\"\n        title=\"\"\n        src=\"/static/06163dfa2179d1fdcb3254429acc3bcd/73d01/appveyor-env.png\"\n        srcset=\"/static/06163dfa2179d1fdcb3254429acc3bcd/a3b1f/appveyor-env.png 197w,\n/static/06163dfa2179d1fdcb3254429acc3bcd/07137/appveyor-env.png 393w,\n/static/06163dfa2179d1fdcb3254429acc3bcd/73d01/appveyor-env.png 786w,\n/static/06163dfa2179d1fdcb3254429acc3bcd/84566/appveyor-env.png 958w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>配置完成。</p>\n<p>当你提交 master 分支和 vx.xx.xx 标签到 github 时，appveyor 将自动构建 windows 安装包并发布到 Github draft release。</p>\n<h3 id=\"travis\"><a href=\"#travis\" aria-label=\"travis permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Travis</h3>\n<p>Travis 的设置与 AppVeyor 类似。添加 <code class=\"language-text\">.travis.yml</code> 文件</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">osx_image: xcode8.3\n\ndist: trusty\nsudo: false\n\nlanguage: node_js\nnode_js: &quot;8&quot;\n\nenv:\n  global:\n    - ELECTRON_CACHE=$HOME/.cache/electron\n    - ELECTRON_BUILDER_CACHE=$HOME/.cache/electron-builder\n\nos:\n  - linux\n  - osx\n\ncache:\n  directories:\n  - node_modules\n  - $HOME/.cache/electron\n  - $HOME/.cache/electron-builder\n  - $HOME/.npm/_prebuilds\n\nscript:\n  - npm run dist\n\nbranches:\n  only:\n    - master</code></pre></div>\n<p><code class=\"language-text\">language</code> 指定 node<em>js,  这样我们可以就使用 node 和 npm 。`node</em>js<code class=\"language-text\">中指定 node 版本。需要特别注意的是</code>os` 段，指定 linux 和 osx，这样 Travis 能够在一次提交中同时运行两个构建，在 linux 下构建\ndeb 包和 appImage，在 osx 下构建 dmg 和 mac。</p>\n<p>同时不要忘了设置 GH_TOKEN。</p>\n<p>你可以使用 travis 命令行工具对 GH_TOKEN 进行加密</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gem install travis\n\ntravis encrypt -r sigoden/alphat GH_TOKEN=&quot;&lt;token&gt;&quot;</code></pre></div>\n<p>该命令会输出如下</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">secure: &quot;&lt;encrypted data&gt;&quot;</code></pre></div>\n<p>将 <code class=\"language-text\">&lt;encrypted data&gt;</code> 添加到 <code class=\"language-text\">.travis.yml</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">env:\n  global:\n    - secure: &quot;&lt;encrypted data&gt;&quot;</code></pre></div>\n<p>同样你也可以在项目设置页面配置环境变量\n\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/54ff361522e88b0d0a25fb7dc0debbc5/a6f40/travis-env.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 786px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 97.1861471861472%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAACKUlEQVQ4y6VUW5LTMBDU/a/BFfiAG2x++NlyAQVOCGV2E/LyS37LTbewUl5nU0ChypSUcWs009OSsdYiyzJUVYXruq5QZCU+JxG+2U/AyN84vmrLYRTgeDyiLEsURYHT6QRbWQYs8Lj5gLh4nMFvAywPMMMwYOh7tG2Lruv83PN/09R+e9UDg3NwtNcylF/V1XXt95mi7dA5XxPcBAjAnoe1Q497Yx70muGRJcbrNTNqXphODBw9/HhGtP+JjtnLr4xUWQj6gsMkSbBarVCyIeJRpoDDdKrGm+gj3n+J0TCQeJYJp8yWQY0252zMKJ7EJ82XMCtpx80nW3n/MGGuuGVTxF/H3TUBI/5/mJadqdjdkvwMs4bMTQ3Dwj/PdJ6xeT6dsTsckF4uuNDSNPVa1CyTThN+31GrwpzPZ4/TJQhyCU2U5Mzbr2usvifeaQkINybwo8zexRs8ENPOMDIFuCn5Txr7VzMl+ct5UqZu05z7uzt775spKImUPBXSGANKj3ayUH54NALHeZ57HcrvNTs1xQfUxwtBdr+H3WxQSrQk2Audazs9GtvtFnEc+3lDnEx+7dccmmh0ndwkascOuqcnOHa5p7+Vj6e6eYlcH9j1KIp8lqpCQy+WfKYbHDqJegJ7081hxuNu93vNTeOd1+bm6lkv6u4q4GtgCVnZk7dRtniylvdYT5eyNT0DqmxpKoBFsN7Ghr6Gsy978gunRlTkOfg0dBlU8i8UoMtfI3X8dwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #ffffff;\"\n        alt=\"travis env\"\n        title=\"\"\n        src=\"/static/54ff361522e88b0d0a25fb7dc0debbc5/73d01/travis-env.png\"\n        srcset=\"/static/54ff361522e88b0d0a25fb7dc0debbc5/a3b1f/travis-env.png 197w,\n/static/54ff361522e88b0d0a25fb7dc0debbc5/07137/travis-env.png 393w,\n/static/54ff361522e88b0d0a25fb7dc0debbc5/73d01/travis-env.png 786w,\n/static/54ff361522e88b0d0a25fb7dc0debbc5/a6f40/travis-env.png 924w\"\n        sizes=\"(max-width: 786px) 100vw, 786px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>配置完成。</p>\n<p>当你提交 master 分支和 vx.xx.xx 标签到 github 时，travis 将自动构建 linux 和 osx 安装包当发布到 Github draft release。</p>\n<h2 id=\"结论\"><a href=\"#%E7%BB%93%E8%AE%BA\" aria-label=\"结论 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>结论</h2>\n<p>上面的介绍配置很简练的，尽管它确实能够为我们搭建了一套构建发布体系，但对于正式的商业应用，仍然有许多要调整补充的。你可能要添加原生包支持，应用签名，发布到到 Mac App Store 或 Windows Store 等方面的配置。但我相信这些都不是大问题，因为文档都有说明，而且 CI 类似虚拟机，允许安装并使用命令，本地做的工作几乎都可以在 CI 上完成。希望大家读了这篇文章后能有所收获。</p>","excerpt":"Electron 是一款可以通过 Web 技术构建跨平台桌面应用的框架。它将 Chromium 和 Node.js 的事件循环整合在一起，并提供了一些与原生系统交互的 API。 通过 Electron，我们可以使用自己所熟悉的前端技术轻松构建出一款能运行在 Windows…","timeToRead":4,"headings":[{"value":"使用 electron-builder","depth":2},{"value":"生成 GH_TOKEN","depth":2},{"value":"配置 CI","depth":2},{"value":"AppVeyor","depth":3},{"value":"Travis","depth":3},{"value":"结论","depth":2}],"frontmatter":{"title":"使用 CI 构建和发布 electron 应用","notoc":null,"excerpt":"通过 Electron，我们可以使用自己所熟悉的前端技术轻松构建出一款能运行在 Windows, Linux 和 Mac 上的桌面级应用程序。本文将介绍一种简单高效的方法构建并发布安装包。","date":"August 16th 2017","rawDate":"2017-08-16"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/build-and-publish-electron-app-with-ci/","prev":{"fields":{"slug":"/how-to-use-getopt-to-build-cli/"},"frontmatter":{"title":"在 Bash 中使用 getopt 解析命令行参数","draft":false,"tags":["howto","linux","bash"]}},"next":{"fields":{"slug":"/verdaccio-private-npm-registry/"},"frontmatter":{"title":"使用 verdaccio 搭建 npm 私有仓储","draft":null,"tags":["howto","registry","npm"]}}}}